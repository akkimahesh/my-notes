(Nginx + PHP-FPM on VM)

Architecture
------------
User → Nginx → PHP-FPM → MySQL

install nginx
-------------
sudo apt update
sudo apt install nginx -y

install PHP and FPM (process manager) like npm
----------------------------------------------
sudo apt install php-fpm php-mysql -y

Configure Nginx for PHP
----------------------
sudo vi /etc/nginx/sites-available/yourapp

ADD
----
server {
    listen 80;
    server_name yourdomain.com;

    root /var/www/yourapp; #change this according to your application path.
    index index.php index.html;

    location / {
        try_files $uri $uri/ /index.php?$query_string;
    }

    location ~ \.php$ {
        include snippets/fastcgi-php.conf;
        fastcgi_pass unix:/var/run/php/php8.1-fpm.sock;
    }

    location ~ /\.ht {
        deny all;
    }
}

Enable
------
#because sites-available/ this directory have all config files. so we need only active files. without effect config files.

sudo ln -s /etc/nginx/sites-available/yourapp /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl restart nginx

Upload project
--------------
clone first
sudo mkdir -p /var/www/yourapp
sudo chown -R www-data:www-data /var/www/yourapp

Restart Services
----------------
sudo systemctl restart php8.1-fpm #check fpm version before run this. php -v
sudo systemctl restart nginx

Deployment completed.

note:
fastcgi_pass unix:/var/run/php/php8.1-fpm.sock; 
#this line equals to /var/run/php/php8.1-fpm.sock

if path different version and nginx config file different version then php-fpm is not redirect to path. 
























